<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reporte Interactivo de Estrategias USD/CLP</title>
    <style>
        /* --- General Setup & Fonts --- */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            margin: 0;
            padding: 0;
            background-color: #FDF7E8; /* Amarillo Background 2 */
            color: #333;
        }

        /* --- Main Container & Header --- */
        .container {
            max-width: 900px;
            margin: 20px auto;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            padding-bottom: 20px;
            border-bottom: 2px solid #E1E9FD; /* Azul Background 2 */
        }
        .header h1 {
            color: #005FFF; /* Azul */
            margin: 0;
        }
        .header p {
            color: #5B86F7; /* Azul Opcional 1 */
            font-size: 1.1em;
            margin-top: 5px;
        }

        /* --- Section Styling --- */
        .section {
            margin-top: 30px;
        }
        .section h2 {
            color: #005FFF; /* Azul */
            border-left: 4px solid #F9B316; /* Amarillo */
            padding-left: 10px;
            margin-bottom: 20px;
        }

        /* --- Analysis Card Styling --- */
        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        .analysis-card {
            background-color: #EBF3E7; /* Verde Background 2 */
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #D4E9C1; /* Verde Background 1 */
        }
        .analysis-card h3 {
            margin-top: 0;
            color: #59A80F; /* Verde */
        }

        /* --- Strategy Card Styling --- */
        .strategy-card {
            background-color: #ffffff;
            border: 1px solid #C3D7FB; /* Azul Background 1 */
            border-radius: 8px;
            padding: 25px;
            margin-top: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .strategy-card.recommended {
            border-left: 5px solid #59A80F; /* Verde */
        }
        .strategy-card.alternative {
            border-left: 5px solid #F9B316; /* Amarillo */
        }
        .strategy-card h3 {
            margin-top: 0;
            font-size: 1.5em;
        }
        .recommended h3 { color: #59A80F; }
        .alternative h3 { color: #F9B316; }

        /* --- SVG Graph Styling --- */
        .pnl-graph-container {
            width: 100%;
            max-width: 550px;
            margin: 20px auto;
            font-size: 12px;
            position: relative;
        }
        .axis { stroke: #aaa; stroke-width: 1; }
        .axis-label { fill: #888; font-size: 0.9em; }
        .payoff-line { stroke-width: 3; fill: none; }
        .profit-zone { fill: #59A80F; opacity: 0.1; }
        .loss-zone { fill: #F40034; opacity: 0.1; }
        .key-point { font-weight: bold; }
        .strike-line { stroke-dasharray: 2, 2; stroke: #888; stroke-width: 1; }
        #pnlIndicatorBear, #pnlIndicatorStrangle {
            stroke: #005FFF; /* Azul */
            stroke-width: 2;
            fill: white;
            transition: transform 0.1s ease; /* Use transform for smoother movement */
        }

        /* --- Interactive Controls Styling --- */
        .interactive-controls {
            background-color: #f7f9fc;
            border: 1px solid #e1e9fd;
            border-radius: 8px;
            padding: 20px;
            margin-top: 25px;
            text-align: center;
        }
        .interactive-controls label {
            font-weight: bold;
            font-size: 1.1em;
            color: #005FFF;
        }
        .interactive-controls input[type="range"] {
            width: 80%;
            margin: 10px 0;
        }
        .pnl-display {
            font-size: 1.8em;
            font-weight: bold;
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            transition: all 0.2s ease;
        }
        .pnl-display.profit-bg { background-color: #EBF3E7; color: #59A80F; }
        .pnl-display.loss-bg { background-color: #FEE9EA; color: #F40034; }
        
        /* --- Table Styling --- */
        .custom-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            font-size: 0.9em;
        }
        .custom-table th, .custom-table td {
            padding: 12px;
            text-align: left;
            border: 1px solid #E1E9FD;
        }
        .custom-table th {
            background-color: #E1E9FD;
            color: #005FFF;
        }
        .custom-table tr:nth-child(even) { background-color: #f8f8f8; }
        .custom-table ul {
            padding-left: 15px;
            margin: 0;
        }

        /* --- Disclaimer Styling --- */
        .footer-disclaimer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #E1E9FD;
            font-size: 0.8em;
            color: #888;
            text-align: justify;
        }
    </style>
</head>
<body>

    <div class="container">
        <div class="header">
            <h1>Reporte Interactivo de Estrategias USD/CLP</h1>
            <p>Análisis Cuantitativo y Recomendación | Fecha: 23-SEP-2025</p>
        </div>

        <div class="section">
            <h2>Análisis del Entorno de Mercado</h2>
            <div class="analysis-grid">
                <div class="analysis-card"><h3>Volatilidad Implícita Alta</h3><p>Las opciones están valoradas por sobre su promedio histórico, incentivando <strong>estrategias de venta de prima</strong>.</p></div>
                <div class="analysis-card"><h3>Skew Positivo</h3><p>El mercado paga una prima extra por los Calls, indicando un <strong>sesgo generalizado al alza del USD</strong>.</p></div>
                <div class="analysis-card"><h3>Kurtosis Positiva</h3><p>El mercado asigna una probabilidad elevada a <strong>movimientos bruscos e inesperados</strong> ("colas pesadas").</p></div>
            </div>
        </div>
        
        <div class="section">
            <h2>Resumen Comparativo de Estrategias (US $1 millón simulado)</h2>
            <table class="custom-table">
                <thead><tr><th>Característica</th><th>Estrategia 1: Bear Call Spread</th><th>Estrategia 2: Short Strangle</th></tr></thead>
                <tbody>
                    <tr><td><strong>Visión</strong></td><td>Moderadamente bajista o neutral. Visión de que la volatilidad implícita está sobrevalorada.</td><td>Neutral / Rango. Fuerte convicción de que la volatilidad implícita caerá y el spot se mantendrá estable.</td></tr>
                    <tr><td><strong>Estructura</strong></td><td>Venta Call (ej: 960) / Compra Call (ej: 975)</td><td>Venta de Call OTM (ej: 970) y Venta de Put OTM (ej: 930)</td></tr>
                    <tr><td><strong>Prima / Costo (CLP)</strong></td><td><ul><li>Ingreso Venta Call 960: +14.290.205</li><li>Costo Compra Call 975: -11.207.987</li><li><strong>= Ingreso Neto: +3.082.218</strong></li></ul></td><td><ul><li>Ingreso Venta Call 970: +9.240.653</li><li>Ingreso Venta Put 930: +8.812.056</li><li><strong>= Ingreso Neto: +18.052.709</strong></li></ul></td></tr>
                    <tr><td><strong>Ganancia Máx.</strong></td><td>Prima Neta Recibida (+3.082.218 CLP)</td><td>Prima Neta Recibida (+18.052.709 CLP)</td></tr>
                    <tr><td><strong>Pérdida Máx.</strong></td><td>Diferencia de Strikes - Prima Neta. Limitada.</td><td>Ilimitada en ambas direcciones.</td></tr>
                    <tr><td><strong>Justificación</strong></td><td>Capitaliza la alta volatilidad implícita y el sesgo alcista, definiendo el riesgo. Ideal si se cree que el alza será limitada.</td><td>Estrategia de máximo ingreso por primas. Apuesta a que el mercado está sobreestimando la probabilidad de un gran movimiento.</td></tr>
                </tbody>
            </table>
        </div>

        <div class="section">
            <h2>Estrategia Recomendada</h2>
            <div class="strategy-card recommended">
                <h3>Bear Call Spread</h3>
                <p>Esta estrategia capitaliza la alta volatilidad y el encarecimiento de los Calls, pero con un <strong>riesgo totalmente definido y limitado</strong>. Es una forma de "agresión disciplinada", ideal para el contexto actual.</p>
                <div class="pnl-graph-container">
                    <svg id="svgBear" viewBox="0 0 400 200">
                        <path class="profit-zone" d="M 0 50 L 200 50 L 221 100 L 0 100 Z"></path>
                        <path class="loss-zone" d="M 221 100 L 275 150 L 400 150 L 400 200 L 0 200 L 0 100 Z"></path>
                        <line x1="0" y1="100" x2="400" y2="100" class="axis"></line><line x1="30" y1="0" x2="30" y2="200" class="axis"></line>
                        <text x="35" y="15" class="axis-label">Ganancia</text><text x="35" y="195" class="axis-label">Pérdida</text>
                        <text x="340" y="95" class="axis-label">Precio Spot →</text>
                        <path d="M 0 50 L 200 50 L 275 150 L 400 150" stroke="#005FFF" class="payoff-line" id="payoffPathBear"></path>
                        <line x1="200" y1="50" x2="200" y2="100" class="strike-line"></line><text x="195" y="115" class="key-point" fill="#333" text-anchor="end">Strike $960</text>
                        <line x1="275" y1="100" x2="275" y2="150" class="strike-line"></line><text x="280" y="115" class="key-point" fill="#333">Strike $975</text>
                        <circle id="pnlIndicatorBear" r="5"></circle>
                    </svg>
                </div>
                <div class="interactive-controls">
                    <label for="spotSliderBear">Mueve para simular el Spot al Vencimiento</label>
                    <div id="spotValueBear" style="font-weight:bold; margin-top:5px;"></div>
                    <input type="range" id="spotSliderBear" min="800" max="1100" value="960" step="0.25">
                    <div id="pnlValueBear" class="pnl-display"></div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Estrategia Alternativa</h2>
            <div class="strategy-card alternative">
                <h3>Short Strangle</h3>
                <p>Genera el mayor ingreso por primas. Sin embargo, expone a un <strong>riesgo de pérdida ilimitada</strong>, desaconsejado por el análisis de Kurtosis.</p>
                <div class="pnl-graph-container">
                    <svg id="svgStrangle" viewBox="0 0 400 200">
                        <path class="profit-zone" d="M 68 100 L 125 40 L 275 40 L 332 100 Z"></path>
                        <path class="loss-zone" d="M 0 180 L 68 100 L 332 100 L 400 180 L 400 200 L 0 200 Z"></path>
                        <line x1="0" y1="100" x2="400" y2="100" class="axis"></line><line x1="30" y1="0" x2="30" y2="200" class="axis"></line>
                        <text x="35" y="15" class="axis-label">Ganancia</text><text x="35" y="195" class="axis-label">Pérdida</text>
                        <text x="340" y="95" class="axis-label">Precio Spot →</text>
                        <path d="M 0 180 L 68 100 L 125 40 L 275 40 L 332 100 L 400 180" stroke="#F40034" class="payoff-line" id="payoffPathStrangle"></path>
                        <line x1="125" y1="40" x2="125" y2="100" class="strike-line"></line><text x="120" y="115" class="key-point" fill="#333" text-anchor="end">Strike $930</text>
                        <line x1="275" y1="40" x2="275" y2="100" class="strike-line"></line><text x="280" y="115" class="key-point" fill="#333">Strike $970</text>
                        <circle id="pnlIndicatorStrangle" r="5"></circle>
                    </svg>
                </div>
                 <div class="interactive-controls">
                    <label for="spotSliderStrangle">Mueve para simular el Spot al Vencimiento</label>
                    <div id="spotValueStrangle" style="font-weight:bold; margin-top:5px;"></div>
                    <input type="range" id="spotSliderStrangle" min="850" max="1050" value="950" step="0.5">
                    <div id="pnlValueStrangle" class="pnl-display"></div>
                </div>
            </div>
        </div>
        
        <div class="footer-disclaimer">
            <p>Este documento ha sido elaborado con el propósito de otorgar información general acerca de Bci Corredor de Bolsa S.A. y puede servir de ayuda para la evaluación y decisión que cada inversionista haga en forma individual e independiente. Aún cuando se ha hecho un esfuerzo razonable, Bci Corredor de Bolsa S.A. no asume la responsabilidad de cualquier recomendación implícita o explícita que en éste se efectúe. Este documento no es una solicitud ni una oferta para comprar o vender ninguno de los instrumentos financieros a los que se hace referencia en él.

Todas las opiniones y expresiones contenidas en esta presentación pueden ser modificadas sin previo aviso. El resultado de cualquier operación financiera realizada con apoyo de la información que aquí se presenta, es exclusiva responsabilidad de la persona que la realiza. Esta información y aquella en la que está basada, ha sido obtenida en base a información pública de fuentes que estimamos confiables. Sin embargo, no garantiza que sea exacta ni completa.

Esta publicación en ningún caso significa que Bci Corredor de Bolsa S.A. pueda hacer oferta pública en Chile, de valores extranjeros que no se encuentren inscritos, tantos éstos como su emisor, en el registro de valores de la Superintendencia de Valores y Seguros. La gestión financiera y el riesgo de la intermediación de valores por Bci Corredor de Bolsa S.A., no guarda relación con la de entidades bancarias o financieras del grupo empresarial al cual pertenece. Bci Corredor de Bolsa S.A. no asume responsabilidad por la solvencia de los emisores de los valores que el cliente adquiera o por la rentabilidad de los mismos.</p>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    // --- LÓGICA COMÚN ---
    const notional = 1000000;
    const clpFormatter = new Intl.NumberFormat('es-CL', { style: 'currency', currency: 'CLP', minimumFractionDigits: 0 });

    // --- LÓGICA PARA EL BEAR CALL SPREAD ---
    const sliderBear = document.getElementById('spotSliderBear');
    const spotValueBear = document.getElementById('spotValueBear');
    const pnlValueBear = document.getElementById('pnlValueBear');
    const pnlIndicatorBear = document.getElementById('pnlIndicatorBear');
    
    const shortStrikeBear = 960;
    const longStrikeBear = 975;
    const netPremiumBear = 3082218;
    const pnlMaxBear = netPremiumBear;
    const pnlMinBear = (shortStrikeBear - longStrikeBear) * notional + netPremiumBear;

    // Puntos de referencia visuales en el SVG
    const svgXFor960 = 200;
    const svgXFor975 = 275;
    const svgYForMaxPnlBear = 50;
    const svgYForMaxLossBear = 150;

    function mapSpotToX_Bear(spot) {
        if (spot <= shortStrikeBear) return svgXFor960 - (shortStrikeBear - spot); // Extiende a la izquierda
        if (spot >= longStrikeBear) return svgXFor975 + (spot - longStrikeBear); // Extiende a la derecha
        const percentage = (spot - shortStrikeBear) / (longStrikeBear - shortStrikeBear);
        return svgXFor960 + percentage * (svgXFor975 - svgXFor960);
    }

    function calculateBearPnl(spot) {
        if (spot <= shortStrikeBear) return pnlMaxBear;
        if (spot >= longStrikeBear) return pnlMinBear;
        return (shortStrikeBear - spot) * notional + netPremiumBear;
    }
    
    function updateBearSpread() {
        const spot = parseFloat(sliderBear.value);
        const pnl = calculateBearPnl(spot);

        spotValueBear.textContent = `Spot Simulado: ${clpFormatter.format(spot)}`;
        pnlValueBear.textContent = `P&L: ${clpFormatter.format(pnl)}`;
        pnlValueBear.className = `pnl-display ${pnl >= 0 ? 'profit-bg' : 'loss-bg'}`;

        const x = mapSpotToX_Bear(spot);
        const y = svgYForMaxPnlBear + (svgYForMaxLossBear - svgYForMaxPnlBear) * (pnlMaxBear - pnl) / (pnlMaxBear - pnlMinBear);
        
        pnlIndicatorBear.setAttribute('cx', x);
        pnlIndicatorBear.setAttribute('cy', y);
    }
    
    sliderBear.addEventListener('input', updateBearSpread);
    updateBearSpread();

    // --- LÓGICA PARA EL SHORT STRANGLE ---
    const sliderStrangle = document.getElementById('spotSliderStrangle');
    const spotValueStrangle = document.getElementById('spotValueStrangle');
    const pnlValueStrangle = document.getElementById('pnlValueStrangle');
    const pnlIndicatorStrangle = document.getElementById('pnlIndicatorStrangle');
    
    const putStrikeStrangle = 930;
    const callStrikeStrangle = 970;
    const netPremiumStrangle = 18052709;
    const lowerBEP = 911.95;
    const upperBEP = 988.05;

    // Puntos de referencia visuales en el SVG
    const svgXForLowerBEP = 68;
    const svgXForPutStrike = 125;
    const svgXForCallStrike = 275;
    const svgXForUpperBEP = 332;
    const svgYForMaxPnlStrangle = 40;
    const svgYForZeroPnl = 100;

    function mapSpotToX_Strangle(spot) {
        if (spot < lowerBEP) return svgXForLowerBEP - (lowerBEP - spot) * 2;
        if (spot < putStrikeStrangle) return svgXForLowerBEP + (spot - lowerBEP) * (svgXForPutStrike - svgXForLowerBEP) / (putStrikeStrangle - lowerBEP);
        if (spot <= callStrikeStrangle) return svgXForPutStrike + (spot - putStrikeStrangle) * (svgXForCallStrike - svgXForPutStrike) / (callStrikeStrangle - putStrikeStrangle);
        if (spot <= upperBEP) return svgXForCallStrike + (spot - callStrikeStrangle) * (svgXForUpperBEP - svgXForCallStrike) / (upperBEP - callStrikeStrangle);
        return svgXForUpperBEP + (spot - upperBEP) * 2;
    }

    function calculateStranglePnl(spot) {
        if (spot >= putStrikeStrangle && spot <= callStrikeStrangle) return netPremiumStrangle;
        if (spot < putStrikeStrangle) return (spot - putStrikeStrangle) * notional + netPremiumStrangle;
        return (callStrikeStrangle - spot) * notional + netPremiumStrangle;
    }
    
    function updateStrangle() {
        const spot = parseFloat(sliderStrangle.value);
        const pnl = calculateStranglePnl(spot);
        
        spotValueStrangle.textContent = `Spot Simulado: ${clpFormatter.format(spot)}`;
        pnlValueStrangle.textContent = `P&L: ${clpFormatter.format(pnl)}`;
        pnlValueStrangle.className = `pnl-display ${pnl >= 0 ? 'profit-bg' : 'loss-bg'}`;
        
        const x = mapSpotToX_Strangle(spot);
        let y;
        if (pnl >= netPremiumStrangle) {
            y = svgYForMaxPnlStrangle;
        } else {
             y = svgYForZeroPnl + (svgYForMaxPnlStrangle - svgYForZeroPnl) * pnl / netPremiumStrangle;
        }

        pnlIndicatorStrangle.setAttribute('cx', x);
        pnlIndicatorStrangle.setAttribute('cy', y);
    }

    sliderStrangle.addEventListener('input', updateStrangle);
    updateStrangle();
});
</script>

</body>
</html>
